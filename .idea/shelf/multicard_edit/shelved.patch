Index: src/routes/builder/CardBuilder.svelte
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><script lang=\"ts\">\r\n  import { onMount } from \"svelte\"\r\n  import { Button, Checkbox, Fileupload, Img, Input, Kbd, Label, Li, List, Select, Textarea } from \"flowbite-svelte\"\r\n  import { cardStats, Color, defaultEmoji, Item, Modifier, Stat, stats, Type, ValueSign } from \"../../states\"\r\n  import { importImages, updateCanvas } from \"../../card_painter\"\r\n  import { browser } from \"$app/environment\"\r\n\r\n  let color = Color.GOLD\r\n  let name = \"\"\r\n  let description = \"\"\r\n  let level = \"i\"\r\n  let handicap = false\r\n  let item = Item.ATTACK\r\n  let initiativeField = \"0\"\r\n  let primaryActionType = Type.ATTACK\r\n  let primaryActionValueField = \"0\"\r\n  let primaryActionValueSign = ValueSign.NONE\r\n  let modifier = Modifier.NONE\r\n  let modifierValueField = \"0\"\r\n  let modifierValueSign = ValueSign.NONE\r\n  let secondaryDefenseValueField = \"0\"\r\n  let secondaryMovementValueField = \"0\"\r\n\r\n  $: initiative = +initiativeField.replace(/[^0-9]/, \"\")\r\n  $: primaryActionValue = +primaryActionValueField.replace(/[^0-9]/, \"\")\r\n  $: modifierValue = +modifierValueField.replace(/[^0-9]/, \"\")\r\n  $: secondaryDefenseValue = +secondaryDefenseValueField.replace(/[^0-9]/, \"\")\r\n  $: secondaryMovementValue = +secondaryMovementValueField.replace(/[^0-9]/, \"\")\r\n\r\n  let imagesLoaded = false\r\n\r\n  let background: HTMLImageElement | undefined\r\n\r\n  let customEmoji: Array<[string, HTMLImageElement]> = []\r\n  let tempCustomEmoji: string | null\r\n\r\n  $: minAttackStatLevelValue = 0\r\n  $: maxAttackStatLevelValue = 0\r\n  $: minDefenseStatLevelValue = 0\r\n  $: maxDefenseStatLevelValue = 0\r\n  $: minInitiativeStatLevelValue = 0\r\n  $: maxInitiativeStatLevelValue = 0\r\n  $: minMovementStatLevelValue = 0\r\n  $: maxMovementStatLevelValue = 0\r\n\r\n  const onFileSelected = (event: Event) => {\r\n    const file = (event.target as HTMLInputElement).files![0]\r\n    const reader = new FileReader()\r\n    reader.readAsDataURL(file)\r\n    reader.onload = event => {\r\n      const image = new Image()\r\n      image.src = event.target!.result! as string\r\n      image.onload = () => {\r\n        background = image\r\n      }\r\n    }\r\n  }\r\n\r\n  const onEmojiSelected = (event: Event, i: number) => {\r\n    const file = (event.target as HTMLInputElement).files![0]\r\n    const reader = new FileReader()\r\n    reader.readAsDataURL(file)\r\n    reader.onload = event => {\r\n      const image = new Image()\r\n      image.src = event.target!.result! as string\r\n      image.onload = () => {\r\n        if (i == customEmoji.length)\r\n          customEmoji = [...customEmoji, [tempCustomEmoji!, image]]\r\n        else\r\n          customEmoji[i][1] = image\r\n        tempCustomEmoji = null\r\n      }\r\n    }\r\n  }\r\n\r\n  $: {\r\n    color\r\n    name\r\n    description\r\n    level\r\n    handicap\r\n    item\r\n    initiative\r\n    primaryActionType\r\n    primaryActionValue\r\n    primaryActionValueSign\r\n    modifier\r\n    modifierValue\r\n    modifierValueSign\r\n    secondaryDefenseValue\r\n    secondaryMovementValue\r\n    background\r\n\r\n    if (imagesLoaded) {\r\n      update()\r\n    }\r\n\r\n    minAttackStatLevelValue = minAttackStatLevel()\r\n    maxAttackStatLevelValue = maxAttackStatLevel()\r\n    minDefenseStatLevelValue = minDefenseStatLevel()\r\n    maxDefenseStatLevelValue = maxDefenseStatLevel()\r\n    minInitiativeStatLevelValue = minInitiativeStatLevel()\r\n    maxInitiativeStatLevelValue = maxInitiativeStatLevel()\r\n    minMovementStatLevelValue = minMovementStatLevel()\r\n    maxMovementStatLevelValue = maxMovementStatLevel()\r\n  }\r\n\r\n  let canvas: HTMLCanvasElement\r\n  let context: CanvasRenderingContext2D\r\n\r\n  $: statImages = new Map()\r\n\r\n  onMount(async () => {\r\n    context = canvas.getContext(\"2d\")!\r\n\r\n    for (const stat of stats) {\r\n      statImages.set(stat, (await import(`../../lib/images/stat_icons/${stat}_white.png`)).default)\r\n    }\r\n    statImages = statImages\r\n\r\n    Promise.all([\r\n      document.fonts.ready,\r\n      importImages(),\r\n    ])\r\n      .then(() => {\r\n        imagesLoaded = true\r\n      })\r\n  })\r\n\r\n  const update = () => updateCanvas(\r\n    canvas,\r\n    context,\r\n    customEmoji,\r\n    background,\r\n    color,\r\n    handicap,\r\n    name,\r\n    description,\r\n    level,\r\n    item,\r\n    initiative,\r\n    primaryActionType,\r\n    primaryActionValue,\r\n    primaryActionValueSign,\r\n    modifier,\r\n    modifierValue,\r\n    modifierValueSign,\r\n    secondaryMovementValue,\r\n    secondaryDefenseValue,\r\n  )\r\n\r\n  const descriptionProps = {\r\n    rows: 4,\r\n  }\r\n\r\n  const colors = [\r\n    { value: Color.GOLD, name: \"Gold\" },\r\n    { value: Color.SILVER, name: \"Silver\" },\r\n    { value: Color.RED, name: \"Red\" },\r\n    { value: Color.BLUE, name: \"Blue\" },\r\n    { value: Color.GREEN, name: \"Green\" },\r\n    { value: Color.PURPLE, name: \"Purple\" },\r\n  ]\r\n\r\n  const levels = [\r\n    { value: \"i\", name: \"I\" },\r\n    { value: \"ii\", name: \"II\" },\r\n    { value: \"iii\", name: \"III\" },\r\n  ]\r\n\r\n  const items = [\r\n    { value: Item.ATTACK, name: \"Attack\" },\r\n    { value: Item.DEFENSE, name: \"Defense\" },\r\n    { value: Item.INITIATIVE, name: \"Initiative\" },\r\n    { value: Item.RANGE, name: \"Range\" },\r\n    { value: Item.AREA, name: \"Area\" },\r\n    { value: Item.MOVEMENT, name: \"Movement\" },\r\n  ]\r\n\r\n  const actionTypes = [\r\n    { value: Type.SKILL, name: \"Skill\" },\r\n    { value: Type.ATTACK, name: \"Attack\" },\r\n    { value: Type.MOVEMENT, name: \"Movement\" },\r\n    { value: Type.DEFENSE, name: \"Defense\" },\r\n    { value: Type.DEFENSE_SKILL, name: \"Defense / Skill\" },\r\n  ]\r\n\r\n  const valueSigns = [\r\n    { value: ValueSign.NONE, name: \"\" },\r\n    { value: ValueSign.PLUS, name: \"+\" },\r\n    { value: ValueSign.MINUS, name: \"-\" },\r\n    { value: ValueSign.EXCLAMATION, name: \"!\" },\r\n  ]\r\n\r\n  const modifierValueSigns = [\r\n    { value: ValueSign.NONE, name: \"\" },\r\n    { value: ValueSign.PLUS, name: \"+\" },\r\n    { value: ValueSign.MINUS, name: \"-\" },\r\n  ]\r\n\r\n  const modifiers = [\r\n    { value: Modifier.NONE, name: \"\" },\r\n    { value: Modifier.RANGE, name: \"Range\" },\r\n    { value: Modifier.AREA, name: \"Area\" },\r\n  ]\r\n\r\n  const labelColor = (disabled: boolean): string => disabled ? \"gray\" : \"white\"\r\n\r\n  $: disableHandicap = color !== Color.GOLD\r\n  $: disableLevel = color !== Color.RED && color !== Color.BLUE && color !== Color.GREEN\r\n  $: disableItem = (level !== \"ii\" && level !== \"iii\") || (color !== Color.RED && color !== Color.BLUE && color !== Color.GREEN)\r\n  $: disableInitiative = color === Color.PURPLE\r\n  $: disablePrimaryActionType = color === Color.PURPLE\r\n  $: disablePrimaryActionValue = color === Color.PURPLE || primaryActionType === Type.SKILL\r\n  $: disableValueSign = color === Color.PURPLE || primaryActionType === Type.SKILL\r\n  $: disableModifierValue = modifier === Modifier.NONE\r\n  $: disableModifierValueSign = modifier === Modifier.NONE\r\n  $: disableSecondaryDefenseValue = color === Color.PURPLE || primaryActionType === Type.DEFENSE || primaryActionType === Type.DEFENSE_SKILL\r\n  $: disableSecondaryMovementValue = color === Color.PURPLE || primaryActionType === Type.MOVEMENT || color === Color.SILVER\r\n\r\n  function downloadCard() {\r\n    const filename = \"card.png\"\r\n    let anchor = document.createElement(\"a\"), event\r\n    anchor.download = filename\r\n    anchor.href = canvas.toDataURL(\"image/png;base64\")\r\n    if (document.createEvent) {\r\n      event = document.createEvent(\"MouseEvents\")\r\n      // ¯\\_(ツ)_/¯\r\n      event.initMouseEvent(\"click\", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)\r\n      anchor.dispatchEvent(event)\r\n    }\r\n  }\r\n\r\n  function minAttackStatLevel() {\r\n    if (primaryActionType == Type.ATTACK)\r\n      return cardStats.get(color)?.get(Stat.ATTACK)?.get(level)?.findIndex((number) => number == primaryActionValue) ?? -1\r\n    return -1\r\n  }\r\n\r\n  function maxAttackStatLevel() {\r\n    if (primaryActionType == Type.ATTACK) {\r\n      let maxAttack = cardStats.get(color)?.get(Stat.ATTACK)?.get(level)?.findLastIndex((number) => number == primaryActionValue) ?? 8\r\n      if (maxAttack == -1) return 8\r\n      return maxAttack\r\n    }\r\n    return 8\r\n  }\r\n\r\n  function minDefenseStatLevel() {\r\n    if (primaryActionType == Type.DEFENSE || primaryActionType == Type.DEFENSE_SKILL)\r\n      return cardStats.get(color)?.get(Stat.DEFENSE)?.get(level)?.findIndex((number) => number == primaryActionValue) ?? -1\r\n    if (secondaryDefenseValue != 0)\r\n      return cardStats.get(color)?.get(Stat.DEFENSE)?.get(level)?.findIndex((number) => number == secondaryDefenseValue) ?? -1\r\n    return -1\r\n  }\r\n\r\n  function maxDefenseStatLevel() {\r\n    if (primaryActionType == Type.DEFENSE || primaryActionType == Type.DEFENSE_SKILL) {\r\n      let maxDefense = cardStats.get(color)?.get(Stat.DEFENSE)?.get(level)?.findLastIndex((number) => number == primaryActionValue) ?? 8\r\n      if (maxDefense == -1) return 8\r\n      return maxDefense\r\n    }\r\n    if (secondaryDefenseValue != 0) {\r\n      let maxDefense = cardStats.get(color)?.get(Stat.DEFENSE)?.get(level)?.findLastIndex((number) => number == secondaryDefenseValue) ?? 8\r\n      if (maxDefense == -1) return 8\r\n      return maxDefense\r\n    }\r\n    return 8\r\n  }\r\n\r\n  function minInitiativeStatLevel() {\r\n    return cardStats.get(color)?.get(Stat.INITIATIVE)?.get(level)?.findIndex((number) => number == initiative) ?? -1\r\n  }\r\n\r\n  function maxInitiativeStatLevel() {\r\n    let maxIni = cardStats.get(color)?.get(Stat.INITIATIVE)?.get(level)?.findLastIndex((number) => number == initiative) ?? 8\r\n    if (maxIni == -1) return 8\r\n    return maxIni\r\n  }\r\n\r\n  function minMovementStatLevel() {\r\n    if (primaryActionType == Type.MOVEMENT)\r\n      return cardStats.get(color)?.get(Stat.MOVEMENT)?.get(level)?.findIndex((number) => number == primaryActionValue) ?? -1\r\n    if (secondaryMovementValue != 0)\r\n      return cardStats.get(color)?.get(Stat.MOVEMENT)?.get(level)?.findIndex((number) => number == secondaryMovementValue) ?? -1\r\n    return -1\r\n  }\r\n\r\n  function maxMovementStatLevel() {\r\n    if (primaryActionType == Type.MOVEMENT) {\r\n      let maxMovement = cardStats.get(color)?.get(Stat.MOVEMENT)?.get(level)?.findLastIndex((number) => number == primaryActionValue) ?? 8\r\n      if (maxMovement == -1) return 8\r\n      return maxMovement\r\n    }\r\n    if (secondaryMovementValue != 0) {\r\n      let maxMovement = cardStats.get(color)?.get(Stat.MOVEMENT)?.get(level)?.findLastIndex((number) => number == secondaryMovementValue) ?? 8\r\n      if (maxMovement == -1) return 8\r\n      return maxMovement\r\n    }\r\n    return 8\r\n  }\r\n\r\n  function getStatPointWidth() {\r\n    if (browser) {\r\n      if (window.innerWidth >= 472) return 20\r\n      else return Math.floor(((window.innerWidth - 16) / 2 - 60) / 8 - 1)\r\n    } else return 0\r\n  }\r\n</script>\r\n\r\n<div class=\"pt-18 md:pt-22\">\r\n  <div class=\"flex items-center flex-col\">\r\n    <div class=\"lg:grid lg:grid-cols-2 lg:gap-6 px-3 lg:px-0\">\r\n      <div class=\"col-span-1 grid grid-cols-6 gap-3 lg:gap-6 max-w-md\">\r\n        <div class=\"col-span-4\">\r\n          <Label style=\"color: white\">\r\n            Color\r\n            <Select items={colors} class=\"bg-dark-800 border-dark-600 text-white disabled:bg-dark-900\"\r\n                    bind:value={color} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2 flex\">\r\n          <div class=\"m-auto\">\r\n            <Checkbox bind:checked={handicap} disabled={disableHandicap}>\r\n              <div style=\"color: {labelColor(disableHandicap)}\">\r\n                Handicap\r\n              </div>\r\n            </Checkbox>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"col-span-6\">\r\n          <Label style=\"color: white\">\r\n            Name\r\n            <Input type=\"text\" class=\"bg-dark-800 border-dark-600 text-white disabled:bg-dark-900\" bind:value={name} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-6\">\r\n          <Label style=\"color: white\">\r\n            Description\r\n            <Textarea {...descriptionProps} class=\"bg-dark-800 border-dark-600 text-white disabled:bg-dark-900\"\r\n                      bind:value={description} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-3\">\r\n          <Label style=\"color: {labelColor(disableLevel)}\">\r\n            Level\r\n            <Select items={levels}\r\n                    class=\"bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                    bind:value={level} disabled={disableLevel} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-3\">\r\n          <Label style=\"color: {labelColor(disableItem)}\">\r\n            Item\r\n            <Select items={items}\r\n                    class=\"bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                    bind:value={item} disabled={disableItem} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-6\">\r\n          <Label style=\"color: {labelColor(disableInitiative)}\">\r\n            Initiative\r\n            <Input type=\"text\"\r\n                   class=\"bg-dark-800 border-dark-600 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                   bind:value={initiativeField} disabled={disableInitiative} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: {labelColor(disablePrimaryActionType)}\">\r\n            Action\r\n            <Select items={actionTypes}\r\n                    class=\"bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                    bind:value={primaryActionType} disabled={disablePrimaryActionType} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: {labelColor(disablePrimaryActionValue)}\">\r\n            Action value\r\n            <Input type=\"text\"\r\n                   class=\"bg-dark-800 border-dark-600 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                   bind:value={primaryActionValueField} disabled={disablePrimaryActionValue} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: {labelColor(disableValueSign)}\">\r\n            Action sign\r\n            <Select items={valueSigns}\r\n                    class=\"bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                    bind:value={primaryActionValueSign} disabled={disableValueSign} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: white\">\r\n            Modifier\r\n            <Select items={modifiers} class=\"bg-dark-800 border-dark-600 text-white disabled:bg-dark-900\"\r\n                    bind:value={modifier} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: {labelColor(disableModifierValue)}\">\r\n            Modifier value\r\n            <Input type=\"text\"\r\n                   class=\"bg-dark-800 border-dark-600 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                   bind:value={modifierValueField} disabled={disableModifierValue} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-2\">\r\n          <Label style=\"color: {labelColor(disableModifierValueSign)}\">\r\n            Modifier sign\r\n            <Select items={modifierValueSigns}\r\n                    class=\"bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                    bind:value={modifierValueSign} disabled={disableModifierValueSign} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-3\">\r\n          <Label style=\"color: {labelColor(disableSecondaryDefenseValue)}\">\r\n            Defense value\r\n            <Input type=\"text\"\r\n                   class=\"bg-dark-800 border-dark-600 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                   bind:value={secondaryDefenseValueField} disabled={disableSecondaryDefenseValue} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-3\">\r\n          <Label style=\"color: {labelColor(disableSecondaryMovementValue)}\">\r\n            Movement value\r\n            <Input type=\"text\"\r\n                   class=\"bg-dark-800 border-dark-600 text-white disabled:text-dark-500 disabled:bg-dark-900\"\r\n                   bind:value={secondaryMovementValueField} disabled={disableSecondaryMovementValue} />\r\n          </Label>\r\n        </div>\r\n\r\n        <div class=\"col-span-6\">\r\n          <Label style=\"color: white\">\r\n            Background (1192×1664)\r\n            <Fileupload class=\"bg-dark-800 border-dark-600 text-white\" on:change={event => onFileSelected(event)} />\r\n          </Label>\r\n        </div>\r\n\r\n        <Label class=\"col-span-6\" style=\"color: white\">\r\n          Custom emoji\r\n          <div class=\"col-span-6 border border-dark-600 rounded-2xl p-3 grid grid-cols-3 gap-3 lg:gap-6\">\r\n            {#each customEmoji as _, i (_)}\r\n              <div class=\"col-span-2\">\r\n                <Input id=\"customEmoji\" type=\"text\" class=\"bg-dark-800 border-dark-600 text-white\"\r\n                       bind:value={customEmoji[i][0]} />\r\n              </div>\r\n              <div class=\"col-span-1\">\r\n                <Fileupload accept=\"image/*\" class=\"bg-dark-800 border-dark-600 text-white\"\r\n                            on:change={event => onFileSelected(event)} />\r\n              </div>\r\n            {/each}\r\n            <div class=\"col-span-2\">\r\n              <Input type=\"text\" class=\"bg-dark-800 border-dark-600 text-white\" bind:value={tempCustomEmoji} />\r\n            </div>\r\n            <div class=\"col-span-1\">\r\n              <Fileupload accept=\"image/*\" class=\"bg-dark-800 border-dark-600 text-white\"\r\n                          on:change={event => onEmojiSelected(event, customEmoji.length)} />\r\n            </div>\r\n          </div>\r\n        </Label>\r\n      </div>\r\n      <div class=\"col-span-1 max-w-md pt-8 lg:pt-0 flex flex-col items-center justify-center\">\r\n        <div class=\"grid grid-cols-2 gap-1 lg:gap-2 w-full\">\r\n          <div class=\"col-span-1 h-7 z-20 relative\">\r\n            <div class=\"h-5 border border-dark-600 bg-transparent hover:bg-transparent rounded-xl bg-dark-900 absolute\">\r\n              <div class=\"m-1 relative h-full\">\r\n                <Img src={statImages.get(\"attack\")} class=\"absolute w-5 z-30 -top-1.25\" />\r\n                <div class=\"float-left w-4.5 h-full bg-transparent\" />\r\n                {#each Array(8) as _, color_index (color_index)}\r\n                  <div class=\"float-left w-1 h-1\" />\r\n                  {#if minAttackStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-600\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else if maxAttackStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-800\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else}\r\n                    <div class=\"float-left h-1 bg-transparent\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {/if}\r\n                {/each}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-span-1 h-7 z-20 relative\">\r\n            <div class=\"h-5 border border-dark-600 bg-transparent hover:bg-transparent rounded-xl bg-dark-900 absolute\">\r\n              <div class=\"m-1 relative h-full\">\r\n                <Img src={statImages.get(\"defense\")} class=\"absolute w-5 z-30 -top-1.25\" />\r\n                <div class=\"float-left w-4.5 h-full bg-transparent\" />\r\n                {#each Array(8) as _, color_index (color_index)}\r\n                  <div class=\"float-left w-1 h-1\" />\r\n                  {#if minDefenseStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-600\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else if maxDefenseStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-800\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else}\r\n                    <div class=\"float-left h-1 bg-transparent\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {/if}\r\n                {/each}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-span-1 h-7 z-20 relative\">\r\n            <div class=\"h-5 border border-dark-600 bg-transparent hover:bg-transparent rounded-xl bg-dark-900 absolute\">\r\n              <div class=\"m-1 relative h-full\">\r\n                <Img src={statImages.get(\"initiative\")} class=\"absolute w-5 z-30 -top-1.25\" />\r\n                <div class=\"float-left w-4.5 h-full bg-transparent\" />\r\n                {#each Array(8) as _, color_index (color_index)}\r\n                  <div class=\"float-left w-1 h-1\" />\r\n                  {#if minInitiativeStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-600\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else if maxInitiativeStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-800\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else}\r\n                    <div class=\"float-left h-1 bg-transparent\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {/if}\r\n                {/each}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-span-1 h-7 z-20 relative\">\r\n            <div class=\"h-5 border border-dark-600 bg-transparent hover:bg-transparent rounded-xl bg-dark-900 absolute\">\r\n              <div class=\"m-1 relative h-full\">\r\n                <Img src={statImages.get(\"movement\")} class=\"absolute w-5 z-30 -top-1.25\" />\r\n                <div class=\"float-left w-4.5 h-full bg-transparent\" />\r\n                {#each Array(8) as _, color_index (color_index)}\r\n                  <div class=\"float-left w-1 h-1\" />\r\n                  {#if minMovementStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-600\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else if maxMovementStatLevelValue >= color_index}\r\n                    <div class=\"z-40 float-left h-2.5 rounded-md bg-amber-800\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {:else}\r\n                    <div class=\"float-left h-1 bg-transparent\" style=\"width: {getStatPointWidth()}px\" />\r\n                  {/if}\r\n                {/each}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"w-full border border-dark-600 bg-transparent hover:bg-transparent rounded-3xl mt-1 md:mt-2\">\r\n          <canvas width=\"1192\" height=\"1664\" class=\"w-full rounded-3xl\" bind:this={canvas} />\r\n        </div>\r\n        <div class=\"flex justify-center\">\r\n          <Button class=\"m-5\" on:click={downloadCard}>Download</Button>\r\n        </div>\r\n      </div>\r\n      <Label class=\"col-span-2\" style=\"color: white\">\r\n        Formatting rules\r\n        <div class=\"max-w-md lg:max-w-4xl border border-dark-600 rounded-2xl p-3\">\r\n          <p class=\"text-white\">\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">**bold**</Kbd> - use this for important info\r\n            such as time conditions\r\n            <br>\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">~italic</Kbd> - use this for notes at the\r\n            bottom (only works at the start of the line)\r\n            <br>\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">>>List option</Kbd> - use this after \"Choose\r\n            one:\" or similar conditions (only works at the start of the line)\r\n            <br>\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">>option continuation</Kbd> - use this after a\r\n            >>List option to avoid creating an extra bullet (only works at the start of the line)\r\n            <br>\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">---</Kbd> - horizontal line - use this to\r\n            split options where no choice is provided (only works at the start of the line)\r\n            <br>\r\n            <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">::emoji_name::</Kbd> - insert an emoji (add\r\n            custom emoji via the form above or use default ones listed below)\r\n          </p>\r\n        </div>\r\n      </Label>\r\n      <Label class=\"col-span-2\" style=\"color: white\">\r\n        Default emoji\r\n        <div class=\"max-w-md lg:max-w-4xl border border-dark-600 rounded-2xl p-3\">\r\n          <p class=\"text-white text-center\">\r\n            {#each defaultEmoji as emoji (emoji)}\r\n              <Kbd class=\"px-1 py-0 text-white bg-dark-700 border-dark-600\">::{emoji}::</Kbd>\r\n              <wbr>\r\n            {/each}\r\n          </p>\r\n        </div>\r\n      </Label>\r\n      <Label class=\"col-span-2\" style=\"color: white\">\r\n        Guidelines\r\n        <div class=\"max-w-md lg:max-w-4xl border border-dark-600 rounded-2xl p-3 mb-3\">\r\n          <Label style=\"color: white\">\r\n            General recommendations <a class=\"text-primary-500\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                                       href=\"https://docs.google.com/spreadsheets/d/1VdgZRXgKdgy0lmWf3k3qkzda1GCQalQY51u7NGNAuYc/edit?usp=sharing\">[source]</a>\r\n            <div class=\"max-w-full border border-dark-600 rounded-2xl p-3 mb-3\">\r\n              <List tag=\"ul\" class=\"space-y-2 text-white\">\r\n                <Li>Keep it simple. While it's tempting to fit a bunch of concepts into a character, this rarely flies\r\n                  without some practice. Start small and build up.\r\n                </Li>\r\n                <Li>The perfect challenge for your first character would be to design a complexity 1 hero.</Li>\r\n                <Li>Break the rules when there is a strong reason to break the rules. Don't break the rules purely in\r\n                  pursuit of making as unique mechanism as possible. It needs to be coherent with the rest of the game.\r\n                </Li>\r\n                <Li>Try to minimize overlaps. Check if similar effects already exist in the game and avoid copying them\r\n                  1:1. This is especially true for gold and silver effects.\r\n                </Li>\r\n                <Li>Find the theme. Every card should resonate with the rest. Both mechanism-wise and theme-wise.</Li>\r\n                <Li>Know how well your character is at each of the 4 roles (Brawler/Initiator/Pusher/Support etc.) and\r\n                  design cards that support that vision.\r\n                </Li>\r\n                <Li>It should be possible to build a character to perform several different roles but not all of them,\r\n                  nor be locked in just one.\r\n                </Li>\r\n                <Li>Try to not make the two branches in the same slot too similar. Otherwise the hero will feel\r\n                  one-dimensional.\r\n                </Li>\r\n                <Li>Keep wording as short as possible. Character should not have 3 lines of text on every card. If you\r\n                  have several cards with lots of text, balance it with the others that don't. Ideally on the same\r\n                  color/tier slot.\r\n                </Li>\r\n                <Li>Minimize the use of tokens and markers.</Li>\r\n                <Li>Miniminze the use of pure defense cards.</Li>\r\n                <Li>Do not overload the character with active effects.</Li>\r\n              </List>\r\n            </div>\r\n          </Label>\r\n          <Label style=\"color: white\">\r\n            Balancing rules and restrictions <a class=\"text-primary-500\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                                                href=\"https://docs.google.com/spreadsheets/d/1VdgZRXgKdgy0lmWf3k3qkzda1GCQalQY51u7NGNAuYc/edit?usp=sharing\">[source]</a>\r\n            <div class=\"max-w-full border border-dark-600 rounded-2xl p-3 mb-3\">\r\n              <List tag=\"ul\" class=\"space-y-2 text-white\">\r\n                <Li>Primary restriction - no character should be able to defeat 2 minions on round 1 on their own (this\r\n                  does not include major screw-ups or multi-character combos).\r\n                </Li>\r\n                <Li>No double attacks directed at minions until Tier III.</Li>\r\n                <Li>Default range for a gold ranged attack is 1. Range 2 requires it to be situational, or both reds to\r\n                  be melee. Range 3 requires it to have severe restriction.\r\n                </Li>\r\n                <Li>No true stuns (complete skip turns effects or equivalents)</Li>\r\n                <Li>Maximum possible coin gain at Tier II = 6 and at Tier III = 8. Average gold income should be around\r\n                  3 coins per round.\r\n                </Li>\r\n                <Li>Maximum possible coin gain at Round 1 = 2. (without other hero's assistance).</Li>\r\n                <Li>Potential minimum coin income at Tier I is 4</Li>\r\n                <Li>Card text must fit into the existing text box with existing text font and size.</Li>\r\n                <Li>Silver, Gold, Ultimate and Tier I cards can fit 8 lines of text max. All other cards - 7 lines of\r\n                  text max. These are lines of text, not full sentences. If you are afraid that your wording is too long\r\n                  - it probably is.\r\n                </Li>\r\n              </List>\r\n            </div>\r\n          </Label>\r\n          <Label style=\"color: white\">\r\n            Card overview\r\n            <div class=\"max-w-full border border-dark-600 rounded-2xl p-3\">\r\n              <List tag=\"ul\" class=\"space-y-2 text-white\">\r\n                <Li>\r\n                  Defense, initiative and movement values of each hero in GoA II depend on their\r\n                  <a class=\"text-primary-500\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                     href=\"https://docs.google.com/spreadsheets/d/1Mvm7YbZ3r5HyocOt3h4iypdrSohEAaa6Omc_WXoBSJc/edit?usp=sharing\">corresponding\r\n                    stats</a>.\r\n                  Two heroes with the same movement stat will <i>generally</i> have the same movement on all of their\r\n                  respective cards.\r\n                </Li>\r\n                <Li>\r\n                  Gold card -\r\n                  Highest initiative,\r\n                  lowest defense,\r\n                  lowest movement,\r\n                  a low-damage attack with a twist or (for some higher-complexity heroes) a skill that provides an\r\n                  option to discard a card or defeat a minion.\r\n                  The Gold card is usually used to land a hit before the enemy can escape, or dodge such a hit.\r\n                  The Gold card doesn't receive any direct upgrades throughout the game and doesn't have an alternative.\r\n                  It is your hero's signature attack.\r\n                </Li>\r\n                <Li>\r\n                  Silver card -\r\n                  Any initiative,\r\n                  low defense,\r\n                  no movement,\r\n                  a skill or (for some higher-complexity heroes) a defense/skill that can do a lot in some situations\r\n                  and nothing in others, due to its conditional nature and no secondary movement.\r\n                  Movement is sometimes present in some form but is always conditional.\r\n                  The Silver cards almost always require some setup in order to bring any value, but when this happens, they\r\n                  can change the situation drastically.\r\n                  The Silver card doesn't receive any direct upgrades throughout the game and doesn't have an alternative.\r\n                  It is you hero's signature skill.\r\n                </Li>\r\n                <Li>\r\n                  Blue card -\r\n                  High initiative,\r\n                  high defense,\r\n                  high movement,\r\n                  a skill, a movement, or a defense.\r\n                  The Blue card is often used for movement, be it evading the red attack or just a reposition.\r\n                  It can also restrict enemies' actions, discard a card, place tokens or apply an effect.\r\n                </Li>\r\n                <Li>\r\n                  Red card -\r\n                  Medium initiative,\r\n                  highest defense,\r\n                  highest movement,\r\n                  a high-damage attack, the main way to strike through enemies' defenses.\r\n                  The easier it is to land a hit with an attack the weaker the damage is. Extra range is usually\r\n                  compensated by lower defense value.\r\n                </Li>\r\n                <Li>\r\n                  Green card -\r\n                  Lowest initiative,\r\n                  medium defense or a block,\r\n                  medium movement,\r\n                  a skill, a movement, or a block that acts as a control tool, due to its low initiative, allowing you\r\n                  to react to the situation: run away from a potential attack, set up an attack, heal or prepare for the\r\n                  next turn in other ways.\r\n                </Li>\r\n                <Li>Initiative, attack and defense on blue, red and green cards increases by 1 either on level II or on\r\n                  level III (same level for both variants).\r\n                </Li>\r\n              </List>\r\n            </div>\r\n          </Label>\r\n        </div>\r\n      </Label>\r\n    </div>\r\n  </div>\r\n\r\n  <p class=\"absolute font-modesto\"></p>\r\n</div>\r\n\r\n<style>\r\n    .font-modesto {\r\n        font-family: \"Modesto Poster\", serif;\r\n    }\r\n\r\n    @font-face{\r\n        font-family: \"Modesto Poster\";\r\n        src: url(\"../../lib/fonts/modesto_poster.woff\") format(\"woff\");\r\n    }\r\n</style>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/routes/builder/CardBuilder.svelte b/src/routes/builder/CardBuilder.svelte
--- a/src/routes/builder/CardBuilder.svelte	(revision 31e0be80c575a6d9caefec9c71160b9110f76392)
+++ b/src/routes/builder/CardBuilder.svelte	(date 1702772372639)
@@ -5,6 +5,353 @@
   import { importImages, updateCanvas } from "../../card_painter"
   import { browser } from "$app/environment"
 
+  const cardValues = new Map<string, Map<string, any>>([
+    ["gold", new Map<string, any>([
+      ["color", Color.GOLD],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["silver", new Map<string, any>([
+      ["color", Color.SILVER],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["purple", new Map<string, any>([
+      ["color", Color.PURPLE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["blueIa", new Map<string, any>([
+      ["color", Color.BLUE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["blueIIa", new Map<string, any>([
+      ["color", Color.BLUE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["blueIIb", new Map<string, any>([
+      ["color", Color.BLUE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["blueIIIa", new Map<string, any>([
+      ["color", Color.BLUE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["blueIIIb", new Map<string, any>([
+      ["color", Color.BLUE],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["redIa", new Map<string, any>([
+      ["color", Color.RED],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["redIIa", new Map<string, any>([
+      ["color", Color.RED],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["redIIb", new Map<string, any>([
+      ["color", Color.RED],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["redIIIa", new Map<string, any>([
+      ["color", Color.RED],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["redIIIb", new Map<string, any>([
+      ["color", Color.RED],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.ATTACK],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["greenIa", new Map<string, any>([
+      ["color", Color.GREEN],
+      ["name", ""],
+      ["description", ""],
+      ["level", "i"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["greenIIa", new Map<string, any>([
+      ["color", Color.GREEN],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["greenIIb", new Map<string, any>([
+      ["color", Color.GREEN],
+      ["name", ""],
+      ["description", ""],
+      ["level", "ii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["greenIIIa", new Map<string, any>([
+      ["color", Color.GREEN],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+    ["greenIIIb", new Map<string, any>([
+      ["color", Color.GREEN],
+      ["name", ""],
+      ["description", ""],
+      ["level", "iii"],
+      ["handicap", false],
+      ["item", Item.ATTACK],
+      ["initiativeField", "0"],
+      ["primaryActionType", Type.SKILL],
+      ["primaryActionValueField", "0"],
+      ["primaryActionValueSign", ValueSign.NONE],
+      ["modifier", Modifier.NONE],
+      ["modifierValueField", "0"],
+      ["modifierValueSign", ValueSign.NONE],
+      ["secondaryDefenseValueField", "0"],
+      ["secondaryMovementValueField", "0"],
+    ])],
+  ])
+
+  let currentCard = "gold"
+
+  function switchCurrentCard(newCard: string) {
+    cardValues.get(currentCard)!.set("color", color)
+    cardValues.get(currentCard)!.set("name", name)
+    cardValues.get(currentCard)!.set("description", description)
+    cardValues.get(currentCard)!.set("level", level)
+    cardValues.get(currentCard)!.set("handicap", handicap)
+    cardValues.get(currentCard)!.set("item", item)
+    cardValues.get(currentCard)!.set("initiativeField", initiativeField)
+    cardValues.get(currentCard)!.set("primaryActionType", primaryActionType)
+    cardValues.get(currentCard)!.set("primaryActionValueField", primaryActionValueField)
+    cardValues.get(currentCard)!.set("primaryActionValueSign", primaryActionValueSign)
+    cardValues.get(currentCard)!.set("modifier", modifier)
+    cardValues.get(currentCard)!.set("modifierValueField", modifierValueField)
+    cardValues.get(currentCard)!.set("modifierValueSign", modifierValueSign)
+    cardValues.get(currentCard)!.set("secondaryDefenseValueField", secondaryDefenseValueField)
+    cardValues.get(currentCard)!.set("secondaryMovementValueField", secondaryMovementValueField)
+
+    currentCard = newCard
+
+    color = cardValues.get(currentCard)!.get("color")!
+    name = cardValues.get(currentCard)!.get("name")!
+    description = cardValues.get(currentCard)!.get("description")!
+    level = cardValues.get(currentCard)!.get("level")!
+    handicap = cardValues.get(currentCard)!.get("handicap")!
+    item = cardValues.get(currentCard)!.get("item")!
+    initiativeField = cardValues.get(currentCard)!.get("initiativeField")!
+    primaryActionType = cardValues.get(currentCard)!.get("primaryActionType")!
+    primaryActionValueField = cardValues.get(currentCard)!.get("primaryActionValueField")!
+    primaryActionValueSign = cardValues.get(currentCard)!.get("primaryActionValueSign")!
+    modifier = cardValues.get(currentCard)!.get("modifier")!
+    modifierValueField = cardValues.get(currentCard)!.get("modifierValueField")!
+    modifierValueSign = cardValues.get(currentCard)!.get("modifierValueSign")!
+    secondaryDefenseValueField = cardValues.get(currentCard)!.get("secondaryDefenseValueField")!
+    secondaryMovementValueField = cardValues.get(currentCard)!.get("secondaryMovementValueField")!
+  }
+
   let color = Color.GOLD
   let name = ""
   let description = ""
@@ -230,6 +577,21 @@
       anchor.dispatchEvent(event)
     }
   }
+
+  function downloadEverything() {
+    const heroCanvas = new
+
+    const filename = "hero.png"
+    let anchor = document.createElement("a"), event
+    anchor.download = filename
+    anchor.href = canvas.toDataURL("image/png;base64")
+    if (document.createEvent) {
+      event = document.createEvent("MouseEvents")
+      // ¯\_(ツ)_/¯
+      event.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)
+      anchor.dispatchEvent(event)
+    }
+  }
 
   function minAttackStatLevel() {
     if (primaryActionType == Type.ATTACK)
@@ -306,30 +668,31 @@
       else return Math.floor(((window.innerWidth - 16) / 2 - 60) / 8 - 1)
     } else return 0
   }
+
+  $: activeBorderGold = currentCard == "gold" ? "bg-yellow-500" : "bg-yellow-300"
+  $: activeBorderSilver = currentCard == "silver" ? "bg-gray-700" : "bg-gray-500"
+  $: activeBorderPurple = currentCard == "purple" ? "bg-purple-800" : "bg-purple-600"
+  $: activeBorderBlueIa = currentCard == "blueIa" ? "bg-blue-800" : "bg-blue-600"
+  $: activeBorderBlueIIa = currentCard == "blueIIa" ? "bg-blue-800" : "bg-blue-600"
+  $: activeBorderBlueIIb = currentCard == "blueIIb" ? "bg-blue-800" : "bg-blue-600"
+  $: activeBorderBlueIIIa = currentCard == "blueIIIa" ? "bg-blue-800" : "bg-blue-600"
+  $: activeBorderBlueIIIb = currentCard == "blueIIIb" ? "bg-blue-800" : "bg-blue-600"
+  $: activeBorderRedIa = currentCard == "redIa" ? "bg-red-800" : "bg-red-600"
+  $: activeBorderRedIIa = currentCard == "redIIa" ? "bg-red-800" : "bg-red-600"
+  $: activeBorderRedIIb = currentCard == "redIIb" ? "bg-red-800" : "bg-red-600"
+  $: activeBorderRedIIIa = currentCard == "redIIIa" ? "bg-red-800" : "bg-red-600"
+  $: activeBorderRedIIIb = currentCard == "redIIIb" ? "bg-red-800" : "bg-red-600"
+  $: activeBorderGreenIa = currentCard == "greenIa" ? "bg-green-800" : "bg-green-600"
+  $: activeBorderGreenIIa = currentCard == "greenIIa" ? "bg-green-800" : "bg-green-600"
+  $: activeBorderGreenIIb = currentCard == "greenIIb" ? "bg-green-800" : "bg-green-600"
+  $: activeBorderGreenIIIa = currentCard == "greenIIIa" ? "bg-green-800" : "bg-green-600"
+  $: activeBorderGreenIIIb = currentCard == "greenIIIb" ? "bg-green-800" : "bg-green-600"
 </script>
 
 <div class="pt-18 md:pt-22">
   <div class="flex items-center flex-col">
     <div class="lg:grid lg:grid-cols-2 lg:gap-6 px-3 lg:px-0">
       <div class="col-span-1 grid grid-cols-6 gap-3 lg:gap-6 max-w-md">
-        <div class="col-span-4">
-          <Label style="color: white">
-            Color
-            <Select items={colors} class="bg-dark-800 border-dark-600 text-white disabled:bg-dark-900"
-                    bind:value={color} />
-          </Label>
-        </div>
-
-        <div class="col-span-2 flex">
-          <div class="m-auto">
-            <Checkbox bind:checked={handicap} disabled={disableHandicap}>
-              <div style="color: {labelColor(disableHandicap)}">
-                Handicap
-              </div>
-            </Checkbox>
-          </div>
-        </div>
-
         <div class="col-span-6">
           <Label style="color: white">
             Name
@@ -345,16 +708,7 @@
           </Label>
         </div>
 
-        <div class="col-span-3">
-          <Label style="color: {labelColor(disableLevel)}">
-            Level
-            <Select items={levels}
-                    class="bg-dark-800 border-dark-600 disabled:border-dark-700 text-white disabled:text-dark-500 disabled:bg-dark-900"
-                    bind:value={level} disabled={disableLevel} />
-          </Label>
-        </div>
-
-        <div class="col-span-3">
+        <div class="col-span-4">
           <Label style="color: {labelColor(disableItem)}">
             Item
             <Select items={items}
@@ -363,6 +717,16 @@
           </Label>
         </div>
 
+        <div class="col-span-2 flex">
+          <div class="m-auto">
+            <Checkbox bind:checked={handicap} disabled={disableHandicap}>
+              <div style="color: {labelColor(disableHandicap)}">
+                Handicap
+              </div>
+            </Checkbox>
+          </div>
+        </div>
+
         <div class="col-span-6">
           <Label style="color: {labelColor(disableInitiative)}">
             Initiative
@@ -548,11 +912,36 @@
             </div>
           </div>
         </div>
-        <div class="w-full border border-dark-600 bg-transparent hover:bg-transparent rounded-3xl mt-1 md:mt-2">
+        <div class="w-full border border-dark-600 rounded-3xl mt-1 md:mt-2">
           <canvas width="1192" height="1664" class="w-full rounded-3xl" bind:this={canvas} />
         </div>
         <div class="flex justify-center">
           <Button class="m-5" on:click={downloadCard}>Download</Button>
+        </div>
+        <div class="flex justify-center">
+          <Button class="m-5" on:click={downloadEverything}>Download Full Set</Button>
+        </div>
+        <div class="grid grid-cols-6 rounded-xl gap-1">
+          <Button class="col-span-1 p-1 hover:bg-yellow-400 {activeBorderGold}" on:click={() => switchCurrentCard("gold")}>D</Button>
+          <Button class="col-span-1 p-1 hover:bg-blue-700 {activeBorderBlueIa}" on:click={() => switchCurrentCard("blueIa")}>B1</Button>
+          <Button class="col-span-1 p-1 hover:bg-blue-700 {activeBorderBlueIIa}" on:click={() => switchCurrentCard("blueIIa")}>B2A</Button>
+          <Button class="col-span-1 p-1 hover:bg-blue-700 {activeBorderBlueIIb}" on:click={() => switchCurrentCard("blueIIb")}>B2B</Button>
+          <Button class="col-span-1 p-1 hover:bg-blue-700 {activeBorderBlueIIIa}" on:click={() => switchCurrentCard("blueIIIa")}>B3A</Button>
+          <Button class="col-span-1 p-1 hover:bg-blue-700 {activeBorderBlueIIIb}" on:click={() => switchCurrentCard("blueIIIb")}>B3B</Button>
+
+          <Button class="col-span-1 p-1 hover:bg-gray-600 {activeBorderSilver}" on:click={() => switchCurrentCard("silver")}>S</Button>
+          <Button class="col-span-1 p-1 hover:bg-red-700 {activeBorderRedIa}" on:click={() => switchCurrentCard("redIa")}>R1</Button>
+          <Button class="col-span-1 p-1 hover:bg-red-700 {activeBorderRedIIa}" on:click={() => switchCurrentCard("redIIa")}>R2A</Button>
+          <Button class="col-span-1 p-1 hover:bg-red-700 {activeBorderRedIIb}" on:click={() => switchCurrentCard("redIIb")}>R2B</Button>
+          <Button class="col-span-1 p-1 hover:bg-red-700 {activeBorderRedIIIa}" on:click={() => switchCurrentCard("redIIIa")}>R3A</Button>
+          <Button class="col-span-1 p-1 hover:bg-red-700 {activeBorderRedIIIb}" on:click={() => switchCurrentCard("redIIIb")}>R3B</Button>
+
+          <Button class="col-span-1 p-1 hover:bg-purple-700 {activeBorderPurple}" on:click={() => switchCurrentCard("purple")}>P</Button>
+          <Button class="col-span-1 p-1 hover:bg-green-700 {activeBorderGreenIa}" on:click={() => switchCurrentCard("greenIa")}>G1</Button>
+          <Button class="col-span-1 p-1 hover:bg-green-700 {activeBorderGreenIIa}" on:click={() => switchCurrentCard("greenIIa")}>G2A</Button>
+          <Button class="col-span-1 p-1 hover:bg-green-700 {activeBorderGreenIIb}" on:click={() => switchCurrentCard("greenIIb")}>G2B</Button>
+          <Button class="col-span-1 p-1 hover:bg-green-700 {activeBorderGreenIIIa}" on:click={() => switchCurrentCard("greenIIIa")}>G3A</Button>
+          <Button class="col-span-1 p-1 hover:bg-green-700 {activeBorderGreenIIIb}" on:click={() => switchCurrentCard("greenIIIb")}>G3B</Button>
         </div>
       </div>
       <Label class="col-span-2" style="color: white">
